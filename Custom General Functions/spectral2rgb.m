function rgb = spectral2rgb(wavelength_nm)
	lambda = [380:830]';
	if wavelength_nm > lambda(end) || wavelength_nm < lambda(1)
		rgb = [0, 0, 0];
		return
	end
	spectralRGB = loadSpectralRGB();
	rgb = spectralRGB(lambda == round(wavelength_nm), :);
end

function spectralRGB = loadSpectralRGB()
	spectralRGB = ...
		[1.26593538742860e-06, 0, 9.70995995995826e-06;
		1.91720649219457e-06, 0, 1.47133812015368e-05;
		2.88625177589998e-06, 0, 2.21629768897533e-05;
		4.31981754580660e-06, 0, 3.31882094410782e-05;
		6.42664577692002e-06, 0, 4.94039256323298e-05;
		9.50427517412303e-06, 0, 7.31077114823166e-05;
		1.39712346975214e-05, 0, 0.000107542701850031;
		2.04144835871202e-05, 0, 0.000157258717416665;
		2.96514029055244e-05, 0, 0.000228598643043025;
		4.28035772501640e-05, 0, 0.000330320902532180;
		6.14268039408479e-05, 0, 0.000474469284232757;
		8.76259988110395e-05, 0, 0.000677484426011095;
		0.000124218114941475, 0, 0.000961634550315801;
		0.000175064313153582, 0, 0.00135685428699225;
		0.000245250542098753, 0, 0.00190323315162346;
		0.000341487792825616, 0, 0.00265366940830773;
		0.000472626675780228, 0, 0.00367796996941900;
		0.000650252039917370, 0, 0.00506760796434274;
		0.000889129367648666, 0, 0.00694097043665262;
		0.00120850105089716, 0, 0.00945777156412075;
		0.00163258369563223, 0, 0.0129788515576159;
		0.00219224444615772, 0, 0.0174043504733972;
		0.00292631528257163, 0, 0.0232112991221473;
		0.00388253137481122, 0, 0.0307959990971620;
		0.00512049015334803, 0, 0.0408309385297902;
		0.00671213334752506, 0, 0.0522616236403173;
		0.00874289935728641, 0, 0.0649292817445778;
		0.0114704686691679, 0, 0.0786678773371723;
		0.0147658220292526, 0, 0.0936991809478536;
		0.0188291580318137, 0, 0.110023013030087;
		0.0238797824519504, 0, 0.127570092047460;
		0.0301083974298385, 0, 0.146533177558651;
		0.0379392311756016, 0, 0.166953208642083;
		0.0468464444867213, 0, 0.188790066422849;
		0.0563922561353523, 0, 0.212135534442984;
		0.0664780925255450, 0, 0.236987989310068;
		0.0771357470507498, 0, 0.263344022997835;
		0.0884620012096440, 0, 0.291231381802236;
		0.100266272165502, 0, 0.320634473050956;
		0.112667998836475, 0, 0.351508802960300;
		0.125527309186351, 0, 0.383850017964258;
		0.138877023640450, 0, 0.417582639262558;
		0.152680353725046, 0, 0.452659355887628;
		0.166962168499786, 0, 0.488987505818728;
		0.181522872605790, 0, 0.526470392580297;
		0.196470672419958, 0, 0.564982307730107;
		0.211601267226798, 0, 0.604434983930277;
		0.226832529156446, 0, 0.644645411406387;
		0.242152764111104, 0, 0.685487805670310;
		0.257415416583955, 0, 0.726750051939538;
		0.272521080575942, 0, 0.768280434622794;
		0.287277344092536, 0, 0.809634870471537;
		0.301534472650439, 0, 0.850426724009343;
		0.315254465163670, 0, 0.890562808184019;
		0.328384294861547, 0, 0.929972561752466;
		0.340913299905679, 0, 0.968612415014527;
		0.352829248197991, 0, 1;
		0.364139256314901, 0, 1;
		0.374853530979489, 0, 1;
		0.384996104981273, 0, 1;
		0.394608917222723, 0, 1;
		0.403333431952994, 0, 1;
		0.410935918343123, 0, 1;
		0.417383293439401, 0, 1;
		0.422758220503045, 0, 1;
		0.427221548104133, 0, 1;
		0.430751777257483, 0, 1;
		0.433569856233383, 0, 1;
		0.435729015913197, 0, 1;
		0.437307817458096, 0, 1;
		0.438499239865540, 0, 1;
		0.439190381138699, 0, 1;
		0.439229430676250, 0, 1;
		0.438577620538617, 0, 1;
		0.437101040483790, 0, 1;
		0.434663866675977, 0, 1;
		0.431376584876282, 0, 1;
		0.426928963339169, 0, 1;
		0.421279013336396, 0, 1;
		0.414324541548915, 0, 1;
		0.405869748851938, 0, 1;
		0.396076356500694, 0, 1;
		0.385095309367783, 0, 1;
		0.372802794215074, 0, 1;
		0.358934227925624, 0, 1;
		0.343277210036856, 0, 1;
		0.325382699340855, 0, 1;
		0.304823593819544, 0, 1;
		0.280738502758401, 0, 1;
		0.252020027223345, 0, 1;
		0.216243565570798, 0, 1;
		0.171297721134646, 0, 1;
		0.109571821129825, 0, 1;
		0, 0, 1;
		0, 0, 1;
		0, 0, 1;
		0, 0, 1;
		0, 0, 1;
		0, 0, 1;
		0, 0, 1;
		0, 0.0874864238738514, 1;
		0, 0.176514824806452, 1;
		0, 0.230756399195187, 1;
		0, 0.272951743756454, 1;
		0, 0.309281945803874, 1;
		0, 0.342457323865654, 1;
		0, 0.373922843886680, 1;
		0, 0.404392531453902, 1;
		0, 0.434234145048943, 1;
		0, 0.463784755777004, 1;
		0, 0.492836408049197, 1;
		0, 0.519934354773601, 1;
		0, 0.544485471864117, 1;
		0, 0.566942321656936, 1;
		0, 0.587549617157329, 1;
		0, 0.606669165363750, 1;
		0, 0.624549021034247, 1;
		0, 0.641450244100726, 1;
		0, 0.657721167611286, 1;
		0, 0.673579577234983, 1;
		0, 0.689359189645081, 1;
		0, 0.705377805902902, 0.986263312090443;
		0, 0.721497208210660, 0.957968328976828;
		0, 0.737303915317449, 0.929686855128611;
		0, 0.752496898314910, 0.901533235874348;
		0, 0.766925249536238, 0.873594457594231;
		0, 0.780485756484234, 0.845974959054187;
		0, 0.793115683099750, 0.818755930320060;
		0, 0.804805281931404, 0.791999584889454;
		0, 0.815586177343829, 0.765775065781671;
		0, 0.825489802395170, 0.740118846942840;
		0, 0.835987274782527, 0.714954345507569;
		0, 0.847985986435980, 0.689937492153011;
		0, 0.860863560725573, 0.664798825714183;
		0, 0.874130510363302, 0.639428837569759;
		0, 0.887422331479139, 0.613775095049993;
		0, 0.900471221851190, 0.587912118298726;
		0, 0.913097937500077, 0.561985047975768;
		0, 0.925235860423678, 0.536208613409133;
		0, 0.936924555946841, 0.510935797019434;
		0, 0.948376928581513, 0.486677175767282;
		0, 0.959754006215663, 0.462682164877159;
		0, 0.970967631640548, 0.437719420171129;
		0, 0.982035157052026, 0.411546130836265;
		0, 0.992953045128168, 0.383972793864968;
		0, 1, 0.354692945299819;
		0, 1, 0.323278181715950;
		0, 1, 0.289219222294498;
		0, 1, 0.251558053407243;
		0, 1, 0.208667471938315;
		0, 1, 0.157008938008493;
		0, 1, 0.0847257246084691;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0, 1, 0;
		0.0705488499226788, 1, 0;
		0.258682718905183, 1, 0;
		0.355809752862719, 1, 0;
		0.429867408499382, 1, 0;
		0.492083504701307, 1, 0;
		0.546815331262798, 1, 0;
		0.596254798061060, 1, 0;
		0.641689903619150, 1, 0;
		0.683922341144001, 1, 0;
		0.723498672223086, 1, 0;
		0.760771505912736, 1, 0;
		0.795989781269801, 1, 0;
		0.829715082358528, 1, 0;
		0.862378796357324, 1, 0;
		0.894000672142392, 1, 0;
		0.924605138660025, 1, 0;
		0.954199114042459, 1, 0;
		0.982767376382553, 1, 0;
		1, 1, 0;
		1, 1, 0;
		1, 0.999580368788005, 0;
		1, 0.987193550904669, 0;
		1, 0.974313447051969, 0;
		1, 0.960870430242082, 0;
		1, 0.946905129306001, 0;
		1, 0.932473481137501, 0;
		1, 0.917639994114866, 0;
		1, 0.902441929709160, 0;
		1, 0.886946715044244, 0;
		1, 0.871208431587236, 0;
		1, 0.855295855393215, 0;
		1, 0.839241612974164, 0;
		1, 0.823031930704800, 0;
		1, 0.806558761733294, 0;
		1, 0.789787494168333, 0;
		1, 0.772701964600737, 0;
		1, 0.755182881327416, 0;
		1, 0.737317286193414, 0;
		1, 0.719001218959634, 0;
		1, 0.700236778779974, 0;
		1, 0.681008494580859, 0;
		1, 0.661380393183907, 0;
		1, 0.641266750662084, 0;
		1, 0.620769604746467, 0;
		1, 0.599807822409553, 0;
		1, 0.578410484734086, 0;
		1, 0.556553178259404, 0;
		1, 0.534161001423070, 0;
		1, 0.511230854658234, 0;
		1, 0.487687682089962, 0;
		1, 0.463442464225608, 0;
		1, 0.438448644110812, 0;
		1, 0.412632857959482, 0;
		1, 0.385863014622559, 0;
		1, 0.357999486059007, 0;
		1, 0.328712292826065, 0;
		1, 0.297582323623727, 0;
		1, 0.263961793617108, 0;
		1, 0.226741875433451, 0;
		1, 0.183796135412383, 0;
		1, 0.129893951028858, 0;
		1, 0.0402558890435091, 0;
		1, 0, 0;
		1, 0, 0;
		1, 0, 0;
		1, 0, 0;
		1, 0, 0;
		1, 0, 0;
		1, 0, 0;
		1, 0, 0;
		1, 0, 0;
		1, 0, 0;
		1, 0, 0;
		1, 0, 0;
		1, 0, 0;
		1, 0, 0;
		1, 0, 0;
		1, 0, 0;
		1, 0, 0;
		1, 0, 0;
		1, 0, 0;
		1, 0, 0;
		1, 0, 0;
		1, 0, 0;
		1, 0, 0;
		1, 0, 0;
		1, 0, 0;
		1, 0, 0;
		1, 0, 0;
		1, 0, 0;
		1, 0, 0;
		1, 0, 0;
		1, 0, 0;
		0.988223588525587, 0, 0;
		0.969144725459081, 0, 0;
		0.950099852190815, 0, 0;
		0.931096043316750, 0, 0;
		0.912114643603874, 0, 0;
		0.893139987247846, 0, 0;
		0.874154140836069, 0, 0;
		0.855151355647203, 0, 0;
		0.836115607174068, 0, 0;
		0.817046262807503, 0, 0;
		0.797976761141867, 0, 0;
		0.778957166359436, 0, 0;
		0.760022287450224, 0, 0;
		0.741228544135151, 0, 0;
		0.722591818800464, 0, 0;
		0.704178346063296, 0, 0;
		0.685999992134344, 0, 0;
		0.668079073421602, 0, 0;
		0.650461158443578, 0, 0;
		0.633105909597260, 0, 0;
		0.615984635261661, 0, 0;
		0.599071683705807, 0, 0;
		0.582439134470809, 0, 0;
		0.566047387204379, 0, 0;
		0.549903959426296, 0, 0;
		0.534044961895007, 0, 0;
		0.518471988027804, 0, 0;
		0.503158924858275, 0, 0;
		0.488157392461871, 0, 0;
		0.473384077966856, 0, 0;
		0.458865364070264, 0, 0;
		0.444593841630168, 0, 0;
		0.430583672303444, 0, 0;
		0.416869962226695, 0, 0;
		0.403457374232858, 0, 0;
		0.390349585512086, 0, 0;
		0.377579515074901, 0, 0;
		0.365138731232344, 0, 0;
		0.353044821631653, 0, 0;
		0.341255016244624, 0, 0;
		0.329748370311438, 0, 0;
		0.318503200428267, 0, 0;
		0.307543864401634, 0, 0;
		0.296886207580177, 0, 0;
		0.286473256810993, 0, 0;
		0.276391058993624, 0, 0;
		0.266547800528674, 0, 0;
		0.256994988920164, 0, 0;
		0.247719174744754, 0, 0;
		0.238677698431109, 0, 0;
		0.229890763684609, 0, 0;
		0.221382152183366, 0, 0;
		0.213065519772024, 0, 0;
		0.205007752735315, 0, 0;
		0.197185381815858, 0, 0;
		0.189557942354814, 0, 0;
		0.182145945048553, 0, 0;
		0.175001801184886, 0, 0;
		0.168009923430910, 0, 0;
		0.161274723537852, 0, 0;
		0.154662489166597, 0, 0;
		0.148262093486082, 0, 0;
		0.142069684513876, 0, 0;
		0.136004849581854, 0, 0;
		0.130230723769654, 0, 0;
		0.124509385487127, 0, 0;
		0.119050219967691, 0, 0;
		0.113737819988694, 0, 0;
		0.108562081380529, 0, 0;
		0.103634653820500, 0, 0;
		0.0987898057996187, 0, 0;
		0.0941325216774352, 0, 0;
		0.0896002862763442, 0, 0;
		0.0851804763444643, 0, 0;
		0.0809522691701563, 0, 0;
		0.0767833951432018, 0, 0;
		0.0728540735451930, 0, 0;
		0.0690411200307784, 0, 0;
		0.0652176173834986, 0, 0;
		0.0615314289269715, 0, 0;
		0.0580036931307917, 0, 0;
		0.0546188101365214, 0, 0;
		0.0513125377473131, 0, 0;
		0.0481025758055512, 0, 0;
		0.0450674095696489, 0, 0;
		0.0420987762597173, 0, 0;
		0.0391627341623983, 0, 0;
		0.0364234608080535, 0, 0;
		0.0336784120699416, 0, 0;
		0.0313542038410495, 0, 0;
		0.0291731044546970, 0, 0;
		0.0271471315802426, 0, 0;
		0.0252660317520257, 0, 0;
		0.0235194845237499, 0, 0;
		0.0218972289713763, 0, 0;
		0.0203909179245828, 0, 0;
		0.0189921803724893, 0, 0;
		0.0176926832933308, 0, 0;
		0.0164859448301966, 0, 0;
		0.0153640323284315, 0, 0;
		0.0143231313256824, 0, 0;
		0.0133470747513892, 0, 0;
		0.0124661075882063, 0, 0;
		0.0115901425348679, 0, 0;
		0.0106242060007896, 0, 0;
		0.00990852372952486, 0, 0;
		0.00925049004842410, 0, 0;
		0.00861723873786524, 0, 0;
		0.00803683746130510, 0, 0;
		0.00749836900231512, 0, 0;
		0.00699589895260070, 0, 0;
		0.00652886165702530, 0, 0;
		0.00609421630216872, 0, 0;
		0.00568977382313806, 0, 0;
		0.00531282797521101, 0, 0;
		0.00496186821620612, 0, 0;
		0.00463430739530299, 0, 0;
		0.00432923352524581, 0, 0;
		0.00404438496673865, 0, 0;
		0.00377877806500485, 0, 0;
		0.00353111581078946, 0, 0;
		0.00329982724912350, 0, 0;
		0.00308447448022556, 0, 0;
		0.00288343398911528, 0, 0;
		0.00269582424105974, 0, 0;
		0.00252085594293660, 0, 0;
		0.00235750873179119, 0, 0;
		0.00220509181707167, 0, 0;
		0.00206283439538220, 0, 0;
		0.00192997916411958, 0, 0;
		0.00180590071779257, 0, 0;
		0.00169002731547110, 0, 0;
		0.00158177918596121, 0, 0;
		0.00148067836634851, 0, 0;
		0.00138627668357740, 0, 0;
		0.00129812181772727, 0, 0;
		0.00121576559175390, 0, 0;
		0.00113888728724817, 0, 0;
		0.00106706061577392, 0, 0;
		0.000999994778945120, 0, 0;
		0.000937305196633882, 0, 0;
		0.000878748996076097, 0, 0;
		0.000823969445893388, 0, 0;
		0.000772745563745979, 0, 0;
		0.000724852222460333, 0, 0;
		0.000679998492407019, 0, 0;
		0.000637995255830910, 0, 0;
		0.000598681115270269, 0, 0;
		0.000561848948048560, 0, 0;
		0.000527351216823076, 0, 0;
		0.000495046601198783, 0, 0;
		0.000464791708462495, 0, 0;
		0.000436423068780904, 0, 0;
		0.000409876951933277, 0, 0;
		0.000384964240092086, 0, 0;
		0.000361648923413426, 0, 0;
		0.000339741884119500, 0, 0;
		0.000319245194334263, 0, 0;
		0.000299979905583165, 0, 0;
		0.000281921600151290, 0, 0;
		0.000264976380567217, 0, 0;
		0.000249078534383599, 0, 0;
		0.000234162051981705, 0, 0;
		0.000220166182572300, 0, 0;
		0.000207036341141366, 0, 0;
		0.000194715170654111, 0, 0;
		0.000183154666345373, 0, 0;
		0.000172303429732206, 0, 0;
		0.000162122018163129, 0, 0;
		0.000152565626318913, 0, 0;
		0.000143595796038305, 0, 0;
		0.000135172307450917, 0, 0;
		0.000127263088322088, 0, 0;
		0.000119832672695245, 0, 0;
		0.000112849402810040, 0, 0;
		0.000106288201133687, 0, 0;
		0.000100118524093166, 0, 0;
		9.43197240489571e-05, 0, 0;
		8.88658816311667e-05, 0, 0;
		8.37434606755045e-05, 0, 0;
		7.89309458604222e-05, 0, 0;
		7.44084021932524e-05, 0, 0;
		7.01543531204982e-05, 0, 0;
		6.61488507325322e-05, 0, 0;
		6.23793562699389e-05, 0, 0;
		5.88237714895365e-05, 0, 0;
		5.54689359397505e-05, 0, 0;
		5.23057045916246e-05, 0, 0;
		4.93157357110345e-05, 0, 0];
end